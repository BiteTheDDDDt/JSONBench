SELECT get_json_string(data, 'commit.collection') AS event, COUNT(*) AS count FROM bluesky GROUP BY event ORDER BY count DESC;
SELECT get_json_string(data, 'commit.collection') AS event, COUNT(*) AS count, COUNT(DISTINCT get_json_string(data, 'did')) AS users FROM bluesky WHERE get_json_string(data, 'kind') = 'commit' AND get_json_string(data, 'commit.operation') = 'create' GROUP BY event ORDER BY count DESC;
SELECT get_json_string(data, 'commit.collection') AS event, HOUR(from_microsecond(get_json_int(data, 'time_us'))) AS hour_of_day, COUNT(*) AS count FROM bluesky WHERE get_json_string(data, 'kind') = 'commit' AND get_json_string(data, 'commit.operation') = 'create' AND get_json_string(data, 'commit.collection') IN ('app.bsky.feed.post', 'app.bsky.feed.repost', 'app.bsky.feed.like') GROUP BY event, hour_of_day ORDER BY hour_of_day, event;
SELECT get_json_string(data, 'did') AS user_id, MIN(from_microsecond(get_json_int(data, 'time_us'))) AS first_post_ts FROM bluesky WHERE get_json_string(data, 'kind') = 'commit' AND get_json_string(data, 'commit.operation') = 'create' AND get_json_string(data, 'commit.collection') = 'app.bsky.feed.post' GROUP BY user_id ORDER BY first_post_ts ASC LIMIT 3;
SELECT get_json_string(data, 'did') AS user_id, MILLISECONDS_DIFF(MAX(from_microsecond(get_json_int(data, 'time_us'))),MIN(from_microsecond(get_json_int(data, 'time_us')))) AS activity_span FROM bluesky WHERE get_json_string(data, 'kind') = 'commit' AND get_json_string(data, 'commit.operation') = 'create' AND get_json_string(data, 'commit.collection') = 'app.bsky.feed.post' GROUP BY user_id ORDER BY activity_span DESC LIMIT 3;
